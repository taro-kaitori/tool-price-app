<code omitted due to length>